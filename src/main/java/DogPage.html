<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dog Detail</title>
</head>
<body>
    <h1>Dog Details</h1>
    <div id="dog-info">
        <p><strong>ID:</strong> <span id="dog-id"></span></p>
        <p><strong>Name:</strong> <span id="dog-name"></span></p>
        <p><strong>Sex:</strong> <span id="dog-sex"></span></p>
        <p><strong>Breed:</strong> <span id="dog-breed"></span></p>
        <p><strong>Age:</strong> <span id="dog-age"></span></p>
        <p><strong>Weight:</strong> <span id="dog-weight"></span></p>
        <p><strong>Price:</strong> <span id="dog-price"></span></p>
        <p><strong>Image:</strong> <img id="dog-image" alt="Dog Image" style="max-width: 300px;"></p>
        <button onclick="addToWishlist()">Add to Wishlist</button>
    </div>
    <br>
    <a href="/results">Back to Results</a> | 
    <a href="/wishlist">Go to Wishlist</a> | 
    <a href="/">Home</a>

    <script>
        // Function to get query parameter by name
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Fetch and display dog details
        function fetchDogDetails() {
            const dogId = getQueryParam('id');
            if (!dogId) {
                document.getElementById('dog-info').innerHTML = 'No dog ID provided in the URL.';
                return;
            }
            fetch(`/dog?id=${dogId}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('dog-id').textContent = data.id;
                    document.getElementById('dog-name').textContent = data.name;
                    document.getElementById('dog-sex').textContent = data.sex;
                    document.getElementById('dog-breed').textContent = data.breed.name;
                    document.getElementById('dog-age').textContent = data.age;
                    document.getElementById('dog-weight').textContent = data.weight;
                    document.getElementById('dog-price').textContent = `$${data.price.toFixed(2)}`;
                    document.getElementById('dog-image').src = data.image;
                    window.currentDog = data;  // Store the current dog data for wishlist addition
                })
                .catch(error => console.error('Error fetching dog details:', error));
        }

        // Add dog to wishlist
        function addToWishlist() {
            fetch('/dog/wishlist', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(window.currentDog)
            })
            .then(response => response.text())
            .then(message => alert(message))
            .catch(error => console.error('Error adding to wishlist:', error));
        }

        // Fetch dog details on page load
        fetchDogDetails();
    </script>
</body>
</html>
