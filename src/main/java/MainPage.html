<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D.E.J.P Dog Adoption Center</title>
    <style>
    /* Sets the base font and removes default margins and padding */
    body {
    font-family: "American Typewriter", sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f0f0f0;
    }

    /* Set center for main content, outlines max width */
    .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    }

    /* Style the header */
    header {
        background-color: darkcyan;
        color: white;
        text-align: center;
        padding: 20px;
    }

    /* Style navigation bar */
    nav {
        background-color: cadetblue;
        padding: 10px;
    }

    /* Remove bullet points from nav bar */
    nav ul {
        list-style-type: none;
        padding: 0;
        text-align: center
    }

    /* Display nav items in order */
    nav ul li {
        display: inline;
        margin: 10px;
    }

    /* Style navigation link */
    nav ul li a {
        color: white;
        text-decoration: none;
    }

    /* Arrange breed button to flex container */
    .breed-buttons {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        margin: 20px 0;
    }

    /* Style breed buttons */
    .breed-button {
        background-color: cadetblue;
        color: white;
        border: none;
        padding: 10px 15px;
        margin: 5px;
        border-radius: 5px;
        cursor: pointer;
    }

    /* Style advanced search */
    .advanced-search {
        background-color: #e0e0e0;
        padding: 20px;
        border-radius: 5px;
        margin-bottom: 20px;
    }

    /* Style advance search user input */
    .advanced-search input, .advanced-search select {
        width: 100%;
        padding: 5px;
    }


    /* Arrange search into grid form */
    .advanced-search form {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
    }

    /* Add margins to youngest dogs */
    .youngest-dogs {
        margin-top: 20px;
    }

    /* Arrange dog cards to flex */
    .dog-cards-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
    }

    /* Style dog cards */
    .dog-card {
        width: 300px;
        margin: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        overflow: hidden;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
    }

    /* Style dog card link */
    .dog-card-link {
        text-decoration: none;
        color: inherit;
        display: block;
    }

    /* Style for dog images */
    .dog-image {
        width: 40%;
        min-height: 150px;
        background-color: #f0f0f0;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Dog images fitting format */
    .dog-image img {
        max-width: 100%;
        max-height: 100%;
        object-fit: cover;
    }

    /* Style dog details in container */
    .dog-details {
        width: 60%;
        padding: 10px;
    }

    /* Remove top margin for dog name */
    .dog-details h3 {
        margin-top: 0;
    }


</style>
</head>
<body>
    <header>
        <h1>D.E.J.P Dog Adoption Center</h1>
    </header>

    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/dogs">Available Dogs</a></li>
            <li><a href="/about">About Us</a></li>
            <li><a href="/contact">Contact</a></li>
        </ul>
    </nav>

    <div class="container">
        /*dog breed buttons*/
        <section class="breed-button">
        <h2>Filter by Breed</h2>
            <div id="breed-buttons">
    </div>
    </section>

    <section class="advanced-search">
        <h2>Advanced Search</h2>
        <form action="/* ip address */" method="get">
            /* user inputs the dog's name */
            <input type="text" name="name" placeholder="Name">

            /* user inputs dog's sex */
            <select name="sex">
                <option value="">Any Sex</option>
                <option value="M">Male</option>
                <option value="F">Female</option>
            </select>

            /* user inputs dog's age range */
            <input type="number" name="minAge" placeholder="Min Age">
            <input type="number" name="maxAge" placeholder="Max Age">

            /* user inputs dog's weight range */
            <input type="number" name="minWeight" placeholder="Min Weight">
            <input type="number" name="maxWeight" placeholder="Max Weight">

            /* user inputs dog's price range */
            <input type="number" name="minPrice" placeholder="Min Price">
            <input type="number" name="maxPrice" placeholder="Max Price">

            /* submit button to carry out advanced search */
            <button type="submit">Search</button>

        </form>
    </section>

    <section class="youngest-dogs">
        <h2>D.E.J.P Dog Adoption Center's Youngest Dogs</h2>
        <div class="youngest-dogs-container" id="youngest-dogs"></div>
    </section>
    </div>

    <footer>
        <p>&copy; 2024 Group 1 Final Project!</p>
    </footer>

    <script>

        /**
         * Filters dogs by breed and navigates to the filtered results page.
         * @function filterByBreed
         * @param {string} breedId - The ID of the breed to filter by
         */
        function filterByBreed(breedId) {
            window.location.href = '/dogs?breed=' + breedId;
        }

        /**
         * Fetches breed data from the server and displays it.
         * @async
         * @function fetchBreeds
         * @returns {Promise<void>}
         */
        async function fetchBreeds() {
            try {
                const response = await fetch('/api/breeds');
                const breeds = await response.json();
                displayBreeds(breeds);
            } catch (error) {
                console.error("Error in fetching breeds", error);
            }
        }

        /**
         * Displays breed buttons based on the fetched breed data.
         * @function displayBreeds
         * @param {Array} breeds - An array of breed objects
         */
        function displayBreeds() {
            const breedButtonsContainer = document.getElementById("breed-buttons");
            breeds.forEach(breed => {
                const button = document.createElement('button');
                button.textContent = breed.name;
                button.classList.add('breed-button');
                button.onclick = () => filterByBreed(breed.id);
                breedButtonsContainer.appendChild(button);
            })

        }

        /**
         * Fetches data about the youngest dogs from the server and displays it.
         * @async
         * @function fetchYoungestDogs
         * @returns {Promise<void>}
         */
        async function fetchYoungestDogs() {
            try {
                const response = await fetch('/api/youngest-dogs');
                const dogs = await response.json();
                displayYoungestDogs()
            } catch (error) {
                console.error('Error fetching youngest dogs:', error);
            }
        }

        /**
         * Displays cards for the youngest dogs.
         * @function displayYoungestDogs
         * @param {Array} dogs - An array of dog objects
         */
        function displayYoungestDogs(dogs) {
            const youngestDogsContainer = document.getElementById("youngest-dogs");
            // Iterate over each dog in the array
            dogs.forEach(dog => {
                // Create a new div element for the dog card
                const dogCard = document.createElement('div');
                // Add the 'dog-card' class to the div
                dogCard.classList.add('dog-card')
                // Set the inner HTML of the dog card
                dogCard.innerHTML = `
                    <a href="/dog?id=${dog.id}" class="dog-card-link">
                        <div class="dog-card-content">
                            <div class="dog-image">
                                <img src="/dogimages/${dog.image}" alt="Dog Image">
                            </div>
                            <div class="dog-details">
                                <h3>${dog.name}</h3>
                                <p>Breed: ${dog.breed.name}</p>
                                <p>Age: ${dog.age} years</p>
                            </div>
                        </div>
                    </a>
                    `;
                youngestDogsContainer.appendChild(dogCard);
            });
        }

        /**
         * Handles the submission of the advanced search form.
         * @function handleAdvancedSearch
         * @param {Event} event - The form submission event
         */
        function advancedSearch() {
            // Prevent the default
            event.preventDefault();
            // Create a FormData object from the form
            const formData = new FormData(event.target);
            // Convert the form data to URL parameters
            const searchParams = new URLSearchParams(formData);
            // Redirect to the search results page with the form data as URL parameters
            window.location.href = '/search?' + searchParams.toString();
        }

        // Add event listener for the advanced search form
        document.getElementById('advanced-search-form').addEventListener('submit', advancedSearch)

        // Call these functions when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            fetchBreeds();
            fetchYoungestDogs();
        });


    </script>

</body>
</html>